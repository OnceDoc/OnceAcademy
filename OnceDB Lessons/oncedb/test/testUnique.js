var oncedb=require("../oncedb")(),assert=require("assert"),client,schema;describe("连接数据库",function(){it("oncedb: 初始化并定义schema",function(e){client=require("redis").createClient(),client.select(4),oncedb.init({client:client},function(t){if(t){console.error(t);return}assert.equal(t,null),oncedb.schema("userUnique",{name:"id;minlen(1);maxlen(256);",mail:'unique("user_mails")',active:"",regist:""}),e()})}),it("Select: 插入顺序数据集",function(e){oncedb.insert("userUnique",{name:"Kris",mail:"c2u@live.cn",active:1,regist:"shanghai"},function(t){assert.equal(t,null),oncedb.upsert("userUnique",{name:"Elon",mail:"52192807@qq.com",active:1,regist:"beijing"},function(t){assert.equal(t,null),oncedb.upsert("userUnique",{name:"Helon",mail:"c2u@live.cn",active:1,regist:"beijing"},function(t){assert.equal(typeof t,"object"),e()})})})}),it("Select: 查找unique",function(e){oncedb.select("userUnique",{mail:"c2u@live.cn",regist:"shanghai"},function(t,n){console.log(n),assert.equal(t,null),assert.equal(n[0].name,"Kris"),e()})}),it("Select: 查找不存在的unique",function(e){oncedb.select("userUnique",{mail:"c2u@live.cn",regist:"beijing"},function(t,n){console.log(n),assert.equal(t,null),assert.equal(n.length,0),e()})}),it("Clear unique数据",function(e){oncedb.remove("userUnique",{name:"Kris"},function(t){oncedb.remove("userUnique",{name:"Elon"},function(t){oncedb.client.keys("*",function(t,n){assert.equal(n.length,0),e()})})})})})/* Powered and Minified by OnceDoc */